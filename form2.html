<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>form practice</title>
    <style>
       
    </style>
</head>
<body>
    <h1 style="background-color: brown;">Form 2</h1>
    <form id="mYform" onsubmit="saveToLocalStorage(event)" >
    <div>
        <h2 style="color: blueviolet;">Enter your details</h2>
    </div>
    <div>
        <label for="Name">enter name</label><br>
        <input type="text" name="username" required>
    </div>
    <div>
        <label for="email">Email</label><br>
        <input type="email" name="emailId" id="Myemail" style="width: 350px" style="background-color: brown;" required>
    </div>
    <div>
        <label>phoneNo</label><br>
        <input type="tel" name="phoneNo" id="phoneNo">
    </div>
    <div>
        <input type="submit" value="Submit">
        
    </div>
    <div>
        <br>
    </div>
</form>
<ul id="listOfItems"></ul>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.2/axios.min.js"></script>
<script>
    function saveToLocalStorage(event){
        event.preventDefault();
        const name = event.target.username.value;
        const email = event.target.emailId.value;
        const phoneNo = event.target.phoneNo.value;
        let obj ={
            name: name,
            email: email,
            no: phoneNo
        }
        axios.post("https://crudcrud.com/api/36d4b933dc8540f98c057063151ab744/appointmentData",obj)
        .then((response)=>{
            console.log(response)
        })
        .catch((err) =>{
            console.log(err)
        })
        //localStorage.setItem(obj.email,JSON.stringify(obj));
       // showUserOnScreen(obj);
    }

    window.addEventListener("DOMContentLoaded",() => {
        axios.get("https://crudcrud.com/api/36d4b933dc8540f98c057063151ab744/appointmentData")
        .then((response) =>{
            console.log(response)

            for (var i=0; i<response.data.length; i++){
                showUserOnScreen(response.data[i]);
            }
        })
        .catch((err) =>{
            console.log(err)
        })
    })


    function showUserOnScreen(obj){
        const parentElem = document.getElementById('listOfItems')
        const childElem = document.createElement('li')
        childElem.textContent = obj.name+"-"+obj.email+"-"+obj.no
        const deleteButton = document.createElement('input')
        deleteButton.type = "button"
        deleteButton.value = "delete"
        deleteButton.onclick = () =>{
            localStorage.removeItem(obj.email)
            parentElem.removeChild(childElem)
        }
        childElem.appendChild(deleteButton);
        parentElem.appendChild(childElem);
    }


    
</script>
    
</body>
</html>